<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pica y Fija PRO</title>

<style>
body{
margin:0;
font-family: 'Segoe UI', sans-serif;
background: linear-gradient(135deg,#ff9a9e,#fad0c4,#a18cd1,#fbc2eb);
background-size:400% 400%;
animation: bg 12s ease infinite;
overflow-x:hidden;
}

@keyframes bg{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

.container{
max-width:500px;
margin:auto;
padding:20px;
text-align:center;
}

.card{
background:rgba(255,255,255,0.25);
backdrop-filter:blur(15px);
border-radius:20px;
padding:25px;
box-shadow:0 8px 25px rgba(0,0,0,0.2);
margin-top:20px;
}

h1{
font-size:28px;
margin-bottom:5px;
}

input{
padding:10px;
font-size:18px;
border-radius:10px;
border:none;
text-align:center;
width:120px;
}

button{
padding:10px 18px;
border:none;
border-radius:12px;
font-size:16px;
cursor:pointer;
margin:5px;
background:#ffffffcc;
transition:0.3s;
}

button:hover{
transform:scale(1.05);
}

.historial{
margin-top:15px;
text-align:left;
max-height:200px;
overflow-y:auto;
font-size:15px;
}

.topBar{
display:flex;
justify-content:center;
align-items:center;
gap:10px;
font-weight:bold;
}

.eye{
cursor:pointer;
font-size:18px;
color:gray;
}

.finalizar{
position:fixed;
bottom:20px;
right:20px;
background:#ff7675;
color:white;
font-weight:bold;
}

.modal{
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.6);
display:flex;
justify-content:center;
align-items:center;
display:none;
}

.modalContent{
background:white;
padding:25px;
border-radius:15px;
text-align:center;
}

.rojo{
color:red;
font-weight:bold;
}
</style>
</head>

<body>

<div class="container">

<!-- MENU -->
<div id="menu" class="card">
<h1>üéØ Pica y Fija PRO</h1>
<p>Eleg√≠ tu n√∫mero secreto</p>
<input id="numeroJugador" maxlength="4" inputmode="numeric">
<br><br>
<button onclick="comenzarJuego()">Comenzar partida</button>
</div>

<!-- TU TURNO -->
<div id="tuTurno" class="card" style="display:none">
<div class="topBar">
<span>Tu n√∫mero:</span>
<span id="numeroVisible">****</span>
<span class="eye" onclick="toggleNumero()">üëÅÔ∏è</span>
</div>

<h2>Tu turno</h2>

<input id="intentoTu" maxlength="4" placeholder="1234" inputmode="numeric">
<br><br>
Fijas:
<input id="fijasTu" type="number" min="0" max="4" style="width:60px">
Picas:
<input id="picasTu" type="number" min="0" max="4" style="width:60px">
<br><br>
<button onclick="agregarIntentoTu()">Aceptar</button>
<button onclick="cambiarPantalla('turnoRival')">Ir a Turno rival</button>

<div class="historial" id="historialTu"></div>
</div>

<!-- TURNO RIVAL -->
<div id="turnoRival" class="card" style="display:none">
<div class="topBar">
<span>Tu n√∫mero:</span>
<span id="numeroVisible2">****</span>
<span class="eye" onclick="toggleNumero()">üëÅÔ∏è</span>
</div>

<h2>Turno rival</h2>

<input id="intentoRival" maxlength="4" placeholder="1234" inputmode="numeric">
<br><br>
<button onclick="agregarIntentoRival()">Aceptar</button>
<button onclick="cambiarPantalla('tuTurno')">Volver a Tu turno</button>

<div class="historial" id="historialRival"></div>
</div>

</div>

<button class="finalizar" onclick="confirmarFinalizar()">Finalizar juego</button>

<!-- MODAL -->
<div class="modal" id="modal">
<div class="modalContent">
<p>¬øEstas seguro que deseas finalizar esta partida?</p>
<button onclick="cerrarModal()">No</button>
<button class="rojo" onclick="finalizarJuego()">Si</button>
</div>
</div>

<script>
let numeroJugador="";
let mostrar=false;
let intentosTu=[];
let intentosRival=[];

function comenzarJuego(){
let num=document.getElementById("numeroJugador").value;

if(!/^\d{4}$/.test(num)){
alert("Debes ingresar exactamente 4 n√∫meros");
return;
}

let set=new Set(num.split(""));
if(set.size!==4){
alert("No se permiten n√∫meros repetidos");
return;
}

numeroJugador=num;
mostrarNumero();
cambiarPantalla("tuTurno");
}

function mostrarNumero(){
document.getElementById("numeroVisible").innerText=mostrar?numeroJugador:"****";
document.getElementById("numeroVisible2").innerText=mostrar?numeroJugador:"****";
}

function toggleNumero(){
mostrar=!mostrar;
mostrarNumero();
}

function cambiarPantalla(p){
document.getElementById("menu").style.display="none";
document.getElementById("tuTurno").style.display="none";
document.getElementById("turnoRival").style.display="none";
document.getElementById(p).style.display="block";
}

function agregarIntentoTu(){
let intento=document.getElementById("intentoTu").value;
let fijas=parseInt(document.getElementById("fijasTu").value)||0;
let picas=parseInt(document.getElementById("picasTu").value)||0;

if(!/^\d{4}$/.test(intento)) return alert("Debe tener 4 d√≠gitos");
if(fijas+picas>4) return alert("Fijas + Picas no puede superar 4");

intentosTu.push({intento,fijas,picas});
renderTu();
document.getElementById("intentoTu").value="";
}

function agregarIntentoRival(){
let intento=document.getElementById("intentoRival").value;
if(!/^\d{4}$/.test(intento)) return alert("Debe tener 4 d√≠gitos");

let fijas=0;
let picas=0;

for(let i=0;i<4;i++){
if(intento[i]===numeroJugador[i]) fijas++;
else if(numeroJugador.includes(intento[i])) picas++;
}

intentosRival.push({intento,fijas,picas});
renderRival();

if(fijas===4){
setTimeout(()=>{
alert("Lo sentimos, perdiste. Adivinaron tu n√∫mero");
finalizarJuego();
},200);
}

document.getElementById("intentoRival").value="";
}

function renderTu(){
let div=document.getElementById("historialTu");
div.innerHTML="";
intentosTu.forEach(x=>{
div.innerHTML+=`<div>${x.intento} ‚Üí ${x.fijas} Fijas, ${x.picas} Picas</div>`;
});
}

function renderRival(){
let div=document.getElementById("historialRival");
div.innerHTML="";
intentosRival.forEach(x=>{
div.innerHTML+=`<div>${x.intento} ‚Üí ${x.fijas} Fijas, ${x.picas} Picas</div>`;
});
}

function confirmarFinalizar(){
document.getElementById("modal").style.display="flex";
}

function cerrarModal(){
document.getElementById("modal").style.display="none";
}

function finalizarJuego(){
intentosTu=[];
intentosRival=[];
numeroJugador="";
document.getElementById("modal").style.display="none";
location.reload();
}

document.addEventListener("keypress",function(e){
if(e.key==="Enter"){
if(document.getElementById("tuTurno").style.display==="block"){
agregarIntentoTu();
}
if(document.getElementById("turnoRival").style.display==="block"){
agregarIntentoRival();
}
}
});
</script>

</body>
</html>
